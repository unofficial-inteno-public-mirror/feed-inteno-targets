#!/bin/sh

create_broadcom_busysboxsymlinks() {
	local bcmbusybox="/usr/sbin/busybox"
	local curbusybox=""
	local createsym=""

	local symlinks="ifconfig sendarp"

	for sym in $symlinks; do
		createsym=""
		if [ ! -f /usr/sbin/$sym ] && [ ! -f /bin/$sym ]; then
			createsym="1"
		elif [ -f /bin/$sym ]; then
			curbusybox="$(ls -hl /bin/$sym | awk '{print$NF}')"
			if [ "$curbusybox" != "$bcmbusybox" ]; then
				createsym="1"
				rm -f /bin/$sym
			fi
		fi
		if [ "$createsym" == "1" ]; then
			cd /bin/
			ln -s $bcmbusybox $sym
		fi
	done
}
boot_hook_add preinit_main create_broadcom_busysboxsymlinks
