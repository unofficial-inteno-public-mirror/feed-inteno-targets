wantest() {
	local wandev=$(db get hw.board.ethernetWanPort)
	local ledontest
	ledontest=$(cat /sys/class/net/$wandev/operstate)
	if [ "$ledontest" == "up" ]; then
		return 0
	fi
	return 1
}

if [ "$INTERFACE" == "led" ]; then
	if [ "$ACTION" == "link_up" ]; then
		ledctl dsl on
	fi

	if [ "$ACTION" == "link_down" ]; then
		ledctl dsl off
		$(wantest) && ledctl broadband on
	fi

	if [ "$ACTION" == "started_training" ]; then
		ledctl dsl alert
	fi

	if [ "$ACTION" == "looking_for_carrier" ]; then
		ledctl dsl notice
	fi
fi

